<!doctype html><html lang=en dir=auto><head><meta charset=utf-8><meta http-equiv=X-UA-Compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=robots content="index, follow"><title>Ethen çš„å®éªŒå®¤</title><meta name=keywords content><meta name=description content="TransitionHandler
TransitionHandler æ˜¯ä¸€ä¸ªæ¥å£ (Interface)ï¼Œå®ƒä¸º Shell åŠ¨ç”»ç³»ç»Ÿå®šä¹‰äº†ä¸€ä¸ª**â€œåŠ¨ç”»å¤„ç†å™¨â€çš„æ ‡å‡†æˆ–å¥‘çº¦**ã€‚
å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªä¸“å®¶å²—ä½è¯´æ˜ä¹¦ ğŸ“œã€‚ä»»ä½•ä¸€ä¸ªç±»ï¼Œåªè¦å®ç°äº† TransitionHandler æ¥å£ï¼Œå°±æ„å‘³ç€å®ƒå…·å¤‡äº†å¤„ç†ä¸€ç±»ç‰¹å®šçª—å£è¿‡æ¸¡åŠ¨ç”»çš„ä¸“ä¸šèƒ½åŠ›ï¼Œå¹¶å¯ä»¥è¢« Transitions ï¼ˆåŠ¨ç”»æ€»è°ƒåº¦å®¤ï¼‰ç»Ÿä¸€ç®¡ç†å’Œè°ƒåº¦ã€‚
æ ¸å¿ƒèŒè´£
ä¸€ä¸ª TransitionHandler å®ç°ç±»ï¼Œå…¶æ ¸å¿ƒèŒè´£ä¸»è¦æœ‰ä¸¤ä¸ªï¼š
1. è®¤é¢†ä»»åŠ¡ (Claim the Job) - é€šè¿‡ handleRequest æ–¹æ³•
è¿™æ˜¯ TransitionHandler æœ€å…³é”®çš„èŒè´£ã€‚å½“ Transitions.requestStartTransition æ–¹æ³•æ”¶åˆ°ä¸€ä¸ªæ¥è‡ªç³»ç»Ÿçš„åŠ¨ç”»è¯·æ±‚æ—¶ï¼Œå®ƒä¼šéå†å…¶å†…éƒ¨çš„ Handler åˆ—è¡¨ï¼Œå¹¶è°ƒç”¨æ¯ä¸ª Handler çš„ handleRequest æ–¹æ³•ã€‚


â€œè¿™æ˜¯æˆ‘çš„æ´»å„¿å—ï¼Ÿâ€: åœ¨ handleRequest æ–¹æ³•å†…éƒ¨ï¼ŒHandler ä¼šæ£€æŸ¥ä¼ å…¥çš„ TransitionRequestInfoï¼ˆåŠ¨ç”»è¯·æ±‚ä¿¡æ¯ï¼‰ï¼Œæ ¹æ®åŠ¨ç”»çš„ç±»å‹ (type)ã€è§¦å‘ä»»åŠ¡ (triggerTask)ã€çª—å£æ¨¡å¼ç­‰ä¿¡æ¯ï¼Œæ¥åˆ¤æ–­è¿™æ˜¯å¦æ˜¯è‡ªå·±åº”è¯¥å¤„ç†çš„åŠ¨ç”»åœºæ™¯ã€‚

ä¾‹å¦‚ï¼ŒRecentsTransitionHandler ä¼šæ£€æŸ¥åŠ¨ç”»ç±»å‹æ˜¯å¦ä¸â€œæœ€è¿‘ä»»åŠ¡â€ç›¸å…³ã€‚
UnfoldTransitionHandler ä¼šæ£€æŸ¥è®¾å¤‡æ˜¯å¦æ­£åœ¨æŠ˜å /å±•å¼€ã€‚



å¦‚ä½•è®¤é¢†:

å¦‚æœ Handler å†³å®šå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª WindowContainerTransaction å¯¹è±¡ï¼ˆå³ä½¿è¿™ä¸ªå¯¹è±¡æ˜¯ç©ºçš„ï¼‰ã€‚è¿™å°±åƒä¸¾æ‰‹è¯´ï¼šâ€œè¿™ä¸ªæˆ‘æ¥å¤„ç†ï¼â€
å¦‚æœ Handler è®¤ä¸ºè¿™ä¸ªè¯·æ±‚ä¸å½’è‡ªå·±ç®¡ï¼Œå®ƒä¼šè¿”å› nullã€‚Transitions çœ‹åˆ° null åï¼Œå°±ä¼šç»§ç»­å»é—®ä¸‹ä¸€ä¸ª Handlerã€‚



2. æ‰§è¡ŒåŠ¨ç”» (Execute the Animation)
ä¸€æ—¦ä¸€ä¸ª Handler é€šè¿‡è¿”å›é null çš„ WCT æˆåŠŸâ€œè®¤é¢†â€äº†ä¸€ä¸ª Transitionï¼Œå®ƒå°±å…¨æƒè´Ÿè´£è¿™ä¸ª Transition çš„åŠ¨ç”»å®ç°ã€‚"><meta name=author content><link rel=canonical href=https://ethen-cao.github.io/ethenslab/android-dev/windowmanager/wmshell/><link crossorigin=anonymous href=/ethenslab/assets/css/stylesheet.a1917769c3c78460b110da6d7905321bb53af4a56f22ba4cc0de824cf4d097ab.css integrity="sha256-oZF3acPHhGCxENpteQUyG7U69KVvIrpMwN6CTPTQl6s=" rel="preload stylesheet" as=style><link rel=icon href=https://ethen-cao.github.io/ethenslab/favicon.ico><link rel=icon type=image/png sizes=16x16 href=https://ethen-cao.github.io/ethenslab/favicon-16x16.png><link rel=icon type=image/png sizes=32x32 href=https://ethen-cao.github.io/ethenslab/favicon-32x32.png><link rel=apple-touch-icon href=https://ethen-cao.github.io/ethenslab/apple-touch-icon.png><link rel=mask-icon href=https://ethen-cao.github.io/ethenslab/safari-pinned-tab.svg><meta name=theme-color content="#2e2e33"><meta name=msapplication-TileColor content="#2e2e33"><link rel=alternate hreflang=en href=https://ethen-cao.github.io/ethenslab/android-dev/windowmanager/wmshell/><noscript><style>#theme-toggle,.top-link{display:none}</style><style>@media(prefers-color-scheme:dark){:root{--theme:rgb(29, 30, 32);--entry:rgb(46, 46, 51);--primary:rgb(218, 218, 219);--secondary:rgb(155, 156, 157);--tertiary:rgb(65, 66, 68);--content:rgb(196, 196, 197);--code-block-bg:rgb(46, 46, 51);--code-bg:rgb(55, 56, 62);--border:rgb(51, 51, 51)}.list{background:var(--theme)}.list:not(.dark)::-webkit-scrollbar-track{background:0 0}.list:not(.dark)::-webkit-scrollbar-thumb{border-color:var(--theme)}}</style></noscript><meta property="og:url" content="https://ethen-cao.github.io/ethenslab/android-dev/windowmanager/wmshell/"><meta property="og:site_name" content="Ethen çš„å®éªŒå®¤"><meta property="og:title" content="Ethen çš„å®éªŒå®¤"><meta property="og:description" content="TransitionHandler TransitionHandler æ˜¯ä¸€ä¸ªæ¥å£ (Interface)ï¼Œå®ƒä¸º Shell åŠ¨ç”»ç³»ç»Ÿå®šä¹‰äº†ä¸€ä¸ª**â€œåŠ¨ç”»å¤„ç†å™¨â€çš„æ ‡å‡†æˆ–å¥‘çº¦**ã€‚
å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªä¸“å®¶å²—ä½è¯´æ˜ä¹¦ ğŸ“œã€‚ä»»ä½•ä¸€ä¸ªç±»ï¼Œåªè¦å®ç°äº† TransitionHandler æ¥å£ï¼Œå°±æ„å‘³ç€å®ƒå…·å¤‡äº†å¤„ç†ä¸€ç±»ç‰¹å®šçª—å£è¿‡æ¸¡åŠ¨ç”»çš„ä¸“ä¸šèƒ½åŠ›ï¼Œå¹¶å¯ä»¥è¢« Transitions ï¼ˆåŠ¨ç”»æ€»è°ƒåº¦å®¤ï¼‰ç»Ÿä¸€ç®¡ç†å’Œè°ƒåº¦ã€‚
æ ¸å¿ƒèŒè´£ ä¸€ä¸ª TransitionHandler å®ç°ç±»ï¼Œå…¶æ ¸å¿ƒèŒè´£ä¸»è¦æœ‰ä¸¤ä¸ªï¼š
1. è®¤é¢†ä»»åŠ¡ (Claim the Job) - é€šè¿‡ handleRequest æ–¹æ³• è¿™æ˜¯ TransitionHandler æœ€å…³é”®çš„èŒè´£ã€‚å½“ Transitions.requestStartTransition æ–¹æ³•æ”¶åˆ°ä¸€ä¸ªæ¥è‡ªç³»ç»Ÿçš„åŠ¨ç”»è¯·æ±‚æ—¶ï¼Œå®ƒä¼šéå†å…¶å†…éƒ¨çš„ Handler åˆ—è¡¨ï¼Œå¹¶è°ƒç”¨æ¯ä¸ª Handler çš„ handleRequest æ–¹æ³•ã€‚
â€œè¿™æ˜¯æˆ‘çš„æ´»å„¿å—ï¼Ÿâ€: åœ¨ handleRequest æ–¹æ³•å†…éƒ¨ï¼ŒHandler ä¼šæ£€æŸ¥ä¼ å…¥çš„ TransitionRequestInfoï¼ˆåŠ¨ç”»è¯·æ±‚ä¿¡æ¯ï¼‰ï¼Œæ ¹æ®åŠ¨ç”»çš„ç±»å‹ (type)ã€è§¦å‘ä»»åŠ¡ (triggerTask)ã€çª—å£æ¨¡å¼ç­‰ä¿¡æ¯ï¼Œæ¥åˆ¤æ–­è¿™æ˜¯å¦æ˜¯è‡ªå·±åº”è¯¥å¤„ç†çš„åŠ¨ç”»åœºæ™¯ã€‚
ä¾‹å¦‚ï¼ŒRecentsTransitionHandler ä¼šæ£€æŸ¥åŠ¨ç”»ç±»å‹æ˜¯å¦ä¸â€œæœ€è¿‘ä»»åŠ¡â€ç›¸å…³ã€‚ UnfoldTransitionHandler ä¼šæ£€æŸ¥è®¾å¤‡æ˜¯å¦æ­£åœ¨æŠ˜å /å±•å¼€ã€‚ å¦‚ä½•è®¤é¢†:
å¦‚æœ Handler å†³å®šå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª WindowContainerTransaction å¯¹è±¡ï¼ˆå³ä½¿è¿™ä¸ªå¯¹è±¡æ˜¯ç©ºçš„ï¼‰ã€‚è¿™å°±åƒä¸¾æ‰‹è¯´ï¼šâ€œè¿™ä¸ªæˆ‘æ¥å¤„ç†ï¼â€ å¦‚æœ Handler è®¤ä¸ºè¿™ä¸ªè¯·æ±‚ä¸å½’è‡ªå·±ç®¡ï¼Œå®ƒä¼šè¿”å› nullã€‚Transitions çœ‹åˆ° null åï¼Œå°±ä¼šç»§ç»­å»é—®ä¸‹ä¸€ä¸ª Handlerã€‚ 2. æ‰§è¡ŒåŠ¨ç”» (Execute the Animation) ä¸€æ—¦ä¸€ä¸ª Handler é€šè¿‡è¿”å›é null çš„ WCT æˆåŠŸâ€œè®¤é¢†â€äº†ä¸€ä¸ª Transitionï¼Œå®ƒå°±å…¨æƒè´Ÿè´£è¿™ä¸ª Transition çš„åŠ¨ç”»å®ç°ã€‚"><meta property="og:locale" content="en"><meta property="og:type" content="article"><meta property="article:section" content="android-dev"><meta name=twitter:card content="summary"><meta name=twitter:title content><meta name=twitter:description content="TransitionHandler
TransitionHandler æ˜¯ä¸€ä¸ªæ¥å£ (Interface)ï¼Œå®ƒä¸º Shell åŠ¨ç”»ç³»ç»Ÿå®šä¹‰äº†ä¸€ä¸ª**â€œåŠ¨ç”»å¤„ç†å™¨â€çš„æ ‡å‡†æˆ–å¥‘çº¦**ã€‚
å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªä¸“å®¶å²—ä½è¯´æ˜ä¹¦ ğŸ“œã€‚ä»»ä½•ä¸€ä¸ªç±»ï¼Œåªè¦å®ç°äº† TransitionHandler æ¥å£ï¼Œå°±æ„å‘³ç€å®ƒå…·å¤‡äº†å¤„ç†ä¸€ç±»ç‰¹å®šçª—å£è¿‡æ¸¡åŠ¨ç”»çš„ä¸“ä¸šèƒ½åŠ›ï¼Œå¹¶å¯ä»¥è¢« Transitions ï¼ˆåŠ¨ç”»æ€»è°ƒåº¦å®¤ï¼‰ç»Ÿä¸€ç®¡ç†å’Œè°ƒåº¦ã€‚
æ ¸å¿ƒèŒè´£
ä¸€ä¸ª TransitionHandler å®ç°ç±»ï¼Œå…¶æ ¸å¿ƒèŒè´£ä¸»è¦æœ‰ä¸¤ä¸ªï¼š
1. è®¤é¢†ä»»åŠ¡ (Claim the Job) - é€šè¿‡ handleRequest æ–¹æ³•
è¿™æ˜¯ TransitionHandler æœ€å…³é”®çš„èŒè´£ã€‚å½“ Transitions.requestStartTransition æ–¹æ³•æ”¶åˆ°ä¸€ä¸ªæ¥è‡ªç³»ç»Ÿçš„åŠ¨ç”»è¯·æ±‚æ—¶ï¼Œå®ƒä¼šéå†å…¶å†…éƒ¨çš„ Handler åˆ—è¡¨ï¼Œå¹¶è°ƒç”¨æ¯ä¸ª Handler çš„ handleRequest æ–¹æ³•ã€‚


â€œè¿™æ˜¯æˆ‘çš„æ´»å„¿å—ï¼Ÿâ€: åœ¨ handleRequest æ–¹æ³•å†…éƒ¨ï¼ŒHandler ä¼šæ£€æŸ¥ä¼ å…¥çš„ TransitionRequestInfoï¼ˆåŠ¨ç”»è¯·æ±‚ä¿¡æ¯ï¼‰ï¼Œæ ¹æ®åŠ¨ç”»çš„ç±»å‹ (type)ã€è§¦å‘ä»»åŠ¡ (triggerTask)ã€çª—å£æ¨¡å¼ç­‰ä¿¡æ¯ï¼Œæ¥åˆ¤æ–­è¿™æ˜¯å¦æ˜¯è‡ªå·±åº”è¯¥å¤„ç†çš„åŠ¨ç”»åœºæ™¯ã€‚

ä¾‹å¦‚ï¼ŒRecentsTransitionHandler ä¼šæ£€æŸ¥åŠ¨ç”»ç±»å‹æ˜¯å¦ä¸â€œæœ€è¿‘ä»»åŠ¡â€ç›¸å…³ã€‚
UnfoldTransitionHandler ä¼šæ£€æŸ¥è®¾å¤‡æ˜¯å¦æ­£åœ¨æŠ˜å /å±•å¼€ã€‚



å¦‚ä½•è®¤é¢†:

å¦‚æœ Handler å†³å®šå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª WindowContainerTransaction å¯¹è±¡ï¼ˆå³ä½¿è¿™ä¸ªå¯¹è±¡æ˜¯ç©ºçš„ï¼‰ã€‚è¿™å°±åƒä¸¾æ‰‹è¯´ï¼šâ€œè¿™ä¸ªæˆ‘æ¥å¤„ç†ï¼â€
å¦‚æœ Handler è®¤ä¸ºè¿™ä¸ªè¯·æ±‚ä¸å½’è‡ªå·±ç®¡ï¼Œå®ƒä¼šè¿”å› nullã€‚Transitions çœ‹åˆ° null åï¼Œå°±ä¼šç»§ç»­å»é—®ä¸‹ä¸€ä¸ª Handlerã€‚



2. æ‰§è¡ŒåŠ¨ç”» (Execute the Animation)
ä¸€æ—¦ä¸€ä¸ª Handler é€šè¿‡è¿”å›é null çš„ WCT æˆåŠŸâ€œè®¤é¢†â€äº†ä¸€ä¸ª Transitionï¼Œå®ƒå°±å…¨æƒè´Ÿè´£è¿™ä¸ª Transition çš„åŠ¨ç”»å®ç°ã€‚"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Androidç³»ç»Ÿå¼€å‘","item":"https://ethen-cao.github.io/ethenslab/android-dev/"},{"@type":"ListItem","position":2,"name":"WindowManager","item":"https://ethen-cao.github.io/ethenslab/android-dev/windowmanager/"},{"@type":"ListItem","position":3,"name":"","item":"https://ethen-cao.github.io/ethenslab/android-dev/windowmanager/wmshell/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","headline":"","name":"","description":"TransitionHandler TransitionHandler æ˜¯ä¸€ä¸ªæ¥å£ (Interface)ï¼Œå®ƒä¸º Shell åŠ¨ç”»ç³»ç»Ÿå®šä¹‰äº†ä¸€ä¸ª**â€œåŠ¨ç”»å¤„ç†å™¨â€çš„æ ‡å‡†æˆ–å¥‘çº¦**ã€‚\nå¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªä¸“å®¶å²—ä½è¯´æ˜ä¹¦ ğŸ“œã€‚ä»»ä½•ä¸€ä¸ªç±»ï¼Œåªè¦å®ç°äº† TransitionHandler æ¥å£ï¼Œå°±æ„å‘³ç€å®ƒå…·å¤‡äº†å¤„ç†ä¸€ç±»ç‰¹å®šçª—å£è¿‡æ¸¡åŠ¨ç”»çš„ä¸“ä¸šèƒ½åŠ›ï¼Œå¹¶å¯ä»¥è¢« Transitions ï¼ˆåŠ¨ç”»æ€»è°ƒåº¦å®¤ï¼‰ç»Ÿä¸€ç®¡ç†å’Œè°ƒåº¦ã€‚\næ ¸å¿ƒèŒè´£ ä¸€ä¸ª TransitionHandler å®ç°ç±»ï¼Œå…¶æ ¸å¿ƒèŒè´£ä¸»è¦æœ‰ä¸¤ä¸ªï¼š\n1. è®¤é¢†ä»»åŠ¡ (Claim the Job) - é€šè¿‡ handleRequest æ–¹æ³• è¿™æ˜¯ TransitionHandler æœ€å…³é”®çš„èŒè´£ã€‚å½“ Transitions.requestStartTransition æ–¹æ³•æ”¶åˆ°ä¸€ä¸ªæ¥è‡ªç³»ç»Ÿçš„åŠ¨ç”»è¯·æ±‚æ—¶ï¼Œå®ƒä¼šéå†å…¶å†…éƒ¨çš„ Handler åˆ—è¡¨ï¼Œå¹¶è°ƒç”¨æ¯ä¸ª Handler çš„ handleRequest æ–¹æ³•ã€‚\nâ€œè¿™æ˜¯æˆ‘çš„æ´»å„¿å—ï¼Ÿâ€: åœ¨ handleRequest æ–¹æ³•å†…éƒ¨ï¼ŒHandler ä¼šæ£€æŸ¥ä¼ å…¥çš„ TransitionRequestInfoï¼ˆåŠ¨ç”»è¯·æ±‚ä¿¡æ¯ï¼‰ï¼Œæ ¹æ®åŠ¨ç”»çš„ç±»å‹ (type)ã€è§¦å‘ä»»åŠ¡ (triggerTask)ã€çª—å£æ¨¡å¼ç­‰ä¿¡æ¯ï¼Œæ¥åˆ¤æ–­è¿™æ˜¯å¦æ˜¯è‡ªå·±åº”è¯¥å¤„ç†çš„åŠ¨ç”»åœºæ™¯ã€‚\nä¾‹å¦‚ï¼ŒRecentsTransitionHandler ä¼šæ£€æŸ¥åŠ¨ç”»ç±»å‹æ˜¯å¦ä¸â€œæœ€è¿‘ä»»åŠ¡â€ç›¸å…³ã€‚ UnfoldTransitionHandler ä¼šæ£€æŸ¥è®¾å¤‡æ˜¯å¦æ­£åœ¨æŠ˜å /å±•å¼€ã€‚ å¦‚ä½•è®¤é¢†:\nå¦‚æœ Handler å†³å®šå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª WindowContainerTransaction å¯¹è±¡ï¼ˆå³ä½¿è¿™ä¸ªå¯¹è±¡æ˜¯ç©ºçš„ï¼‰ã€‚è¿™å°±åƒä¸¾æ‰‹è¯´ï¼šâ€œè¿™ä¸ªæˆ‘æ¥å¤„ç†ï¼â€ å¦‚æœ Handler è®¤ä¸ºè¿™ä¸ªè¯·æ±‚ä¸å½’è‡ªå·±ç®¡ï¼Œå®ƒä¼šè¿”å› nullã€‚Transitions çœ‹åˆ° null åï¼Œå°±ä¼šç»§ç»­å»é—®ä¸‹ä¸€ä¸ª Handlerã€‚ 2. æ‰§è¡ŒåŠ¨ç”» (Execute the Animation) ä¸€æ—¦ä¸€ä¸ª Handler é€šè¿‡è¿”å›é null çš„ WCT æˆåŠŸâ€œè®¤é¢†â€äº†ä¸€ä¸ª Transitionï¼Œå®ƒå°±å…¨æƒè´Ÿè´£è¿™ä¸ª Transition çš„åŠ¨ç”»å®ç°ã€‚\n","keywords":[],"articleBody":"TransitionHandler TransitionHandler æ˜¯ä¸€ä¸ªæ¥å£ (Interface)ï¼Œå®ƒä¸º Shell åŠ¨ç”»ç³»ç»Ÿå®šä¹‰äº†ä¸€ä¸ª**â€œåŠ¨ç”»å¤„ç†å™¨â€çš„æ ‡å‡†æˆ–å¥‘çº¦**ã€‚\nå¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ªä¸“å®¶å²—ä½è¯´æ˜ä¹¦ ğŸ“œã€‚ä»»ä½•ä¸€ä¸ªç±»ï¼Œåªè¦å®ç°äº† TransitionHandler æ¥å£ï¼Œå°±æ„å‘³ç€å®ƒå…·å¤‡äº†å¤„ç†ä¸€ç±»ç‰¹å®šçª—å£è¿‡æ¸¡åŠ¨ç”»çš„ä¸“ä¸šèƒ½åŠ›ï¼Œå¹¶å¯ä»¥è¢« Transitions ï¼ˆåŠ¨ç”»æ€»è°ƒåº¦å®¤ï¼‰ç»Ÿä¸€ç®¡ç†å’Œè°ƒåº¦ã€‚\næ ¸å¿ƒèŒè´£ ä¸€ä¸ª TransitionHandler å®ç°ç±»ï¼Œå…¶æ ¸å¿ƒèŒè´£ä¸»è¦æœ‰ä¸¤ä¸ªï¼š\n1. è®¤é¢†ä»»åŠ¡ (Claim the Job) - é€šè¿‡ handleRequest æ–¹æ³• è¿™æ˜¯ TransitionHandler æœ€å…³é”®çš„èŒè´£ã€‚å½“ Transitions.requestStartTransition æ–¹æ³•æ”¶åˆ°ä¸€ä¸ªæ¥è‡ªç³»ç»Ÿçš„åŠ¨ç”»è¯·æ±‚æ—¶ï¼Œå®ƒä¼šéå†å…¶å†…éƒ¨çš„ Handler åˆ—è¡¨ï¼Œå¹¶è°ƒç”¨æ¯ä¸ª Handler çš„ handleRequest æ–¹æ³•ã€‚\nâ€œè¿™æ˜¯æˆ‘çš„æ´»å„¿å—ï¼Ÿâ€: åœ¨ handleRequest æ–¹æ³•å†…éƒ¨ï¼ŒHandler ä¼šæ£€æŸ¥ä¼ å…¥çš„ TransitionRequestInfoï¼ˆåŠ¨ç”»è¯·æ±‚ä¿¡æ¯ï¼‰ï¼Œæ ¹æ®åŠ¨ç”»çš„ç±»å‹ (type)ã€è§¦å‘ä»»åŠ¡ (triggerTask)ã€çª—å£æ¨¡å¼ç­‰ä¿¡æ¯ï¼Œæ¥åˆ¤æ–­è¿™æ˜¯å¦æ˜¯è‡ªå·±åº”è¯¥å¤„ç†çš„åŠ¨ç”»åœºæ™¯ã€‚\nä¾‹å¦‚ï¼ŒRecentsTransitionHandler ä¼šæ£€æŸ¥åŠ¨ç”»ç±»å‹æ˜¯å¦ä¸â€œæœ€è¿‘ä»»åŠ¡â€ç›¸å…³ã€‚ UnfoldTransitionHandler ä¼šæ£€æŸ¥è®¾å¤‡æ˜¯å¦æ­£åœ¨æŠ˜å /å±•å¼€ã€‚ å¦‚ä½•è®¤é¢†:\nå¦‚æœ Handler å†³å®šå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª WindowContainerTransaction å¯¹è±¡ï¼ˆå³ä½¿è¿™ä¸ªå¯¹è±¡æ˜¯ç©ºçš„ï¼‰ã€‚è¿™å°±åƒä¸¾æ‰‹è¯´ï¼šâ€œè¿™ä¸ªæˆ‘æ¥å¤„ç†ï¼â€ å¦‚æœ Handler è®¤ä¸ºè¿™ä¸ªè¯·æ±‚ä¸å½’è‡ªå·±ç®¡ï¼Œå®ƒä¼šè¿”å› nullã€‚Transitions çœ‹åˆ° null åï¼Œå°±ä¼šç»§ç»­å»é—®ä¸‹ä¸€ä¸ª Handlerã€‚ 2. æ‰§è¡ŒåŠ¨ç”» (Execute the Animation) ä¸€æ—¦ä¸€ä¸ª Handler é€šè¿‡è¿”å›é null çš„ WCT æˆåŠŸâ€œè®¤é¢†â€äº†ä¸€ä¸ª Transitionï¼Œå®ƒå°±å…¨æƒè´Ÿè´£è¿™ä¸ª Transition çš„åŠ¨ç”»å®ç°ã€‚\nå‡†å¤‡ä¸æ‰§è¡Œ: å½“ TransitionController å®Œæˆæ‰€æœ‰å‡†å¤‡å·¥ä½œï¼Œå¹¶é€šè¿‡ onTransitionReady å°†åŒ…å«å®Œæ•´ä¿¡æ¯çš„ TransitionInfo å‘é€å› Shell åï¼ŒTransitions æ€»è°ƒåº¦å®¤ä¼šç¡®ä¿å°†è¿™ä¸ª TransitionInfo äº¤ç»™å½“åˆè®¤é¢†äº†å®ƒçš„é‚£ä¸ª Handlerã€‚ å…·ä½“çš„åŠ¨ç”»é€»è¾‘: Handler å†…éƒ¨ä¼šåŒ…å«å…·ä½“çš„åŠ¨ç”»ä»£ç ã€‚å®ƒä¼šè§£æ TransitionInfoï¼Œè·å–éœ€è¦æ“ä½œçš„çª—å£å›¾å±‚ï¼ˆLeashesï¼‰ï¼Œç„¶åä½¿ç”¨ SurfaceControl.Transaction æ¥å®ç°å¹³ç§»ã€ç¼©æ”¾ã€é€æ˜åº¦å˜åŒ–ç­‰ä¸€ç³»åˆ—è§†è§‰æ•ˆæœï¼Œæœ€ç»ˆæ„æˆä¸€ä¸ªå®Œæ•´çš„åŠ¨ç”»ã€‚ è®¾è®¡æ¨¡å¼ä¸ä¼˜åŠ¿ è¿™ä¸ªè®¾è®¡é‡‡ç”¨äº†ç»å…¸çš„è´£ä»»é“¾æ¨¡å¼ (Chain of Responsibility) æˆ–ç­–ç•¥æ¨¡å¼ (Strategy Pattern)ã€‚\næ¨¡å—åŒ– (Modularity): å°†ä¸åŒåœºæ™¯çš„åŠ¨ç”»é€»è¾‘éš”ç¦»åœ¨å„è‡ªç‹¬ç«‹çš„ Handler ç±»ä¸­ã€‚RecentsTransitionHandler åªå…³å¿ƒâ€œæœ€è¿‘ä»»åŠ¡â€ï¼ŒPipTransitionController åªå…³å¿ƒç”»ä¸­ç”»ï¼Œå®ƒä»¬äº’ä¸å¹²æ‰°ã€‚ å¯æ‰©å±•æ€§ (Extensibility): è¿™ä¸ªæ¶æ„éå¸¸å®¹æ˜“æ‰©å±•ã€‚å¦‚æœæœªæ¥ Android å¢åŠ äº†ä¸€ç§æ–°çš„çª—å£æ¨¡å¼ï¼ˆæ¯”å¦‚â€œè¿·ä½ æ¨¡å¼â€ï¼‰ï¼Œå¼€å‘è€…åªéœ€è¦ï¼š åˆ›å»ºä¸€ä¸ªæ–°çš„ MiniModeTransitionHandler ç±»ï¼Œå¹¶å®ç° TransitionHandler æ¥å£ã€‚ åœ¨æ–°ç±»ä¸­ç¼–å†™è¿›å…¥/é€€å‡ºâ€œè¿·ä½ æ¨¡å¼â€çš„åŠ¨ç”»é€»è¾‘ã€‚ å°†è¿™ä¸ªæ–°çš„ Handler æ³¨å†Œåˆ° Transitions çš„ Handler åˆ—è¡¨ä¸­ã€‚ æ•´ä¸ªåŠ¨ç”»ç³»ç»Ÿå°±èƒ½è‡ªåŠ¨æ”¯æŒè¿™ç§æ–°çš„åŠ¨ç”»ï¼Œè€Œæ— éœ€ä¿®æ”¹ä»»ä½•ç°æœ‰çš„æ ¸å¿ƒä»£ç ã€‚ ä¼˜å…ˆçº§ (Prioritization): Transitions å†…éƒ¨çš„ Handler åˆ—è¡¨æ˜¯æœ‰é¡ºåºçš„ã€‚è¿™å…è®¸ç³»ç»Ÿå®šä¹‰å¤„ç†çš„ä¼˜å…ˆçº§ã€‚æ¯”å¦‚ï¼ŒUnfoldTransitionHandlerï¼ˆæŠ˜å å±ä¸“å®¶ï¼‰çš„ä¼˜å…ˆçº§ä¼šé«˜äº DefaultTransitionHandlerï¼ˆé€šç”¨ä¸“å®¶ï¼‰ï¼Œç¡®ä¿åœ¨æŠ˜å å±è®¾å¤‡ä¸Šï¼Œä¼˜å…ˆæ‰§è¡Œä¸“é—¨ä¸ºæŠ˜å å±ä¼˜åŒ–çš„åŠ¨ç”»ã€‚ æ€»ç»“ TransitionHandler æ¥å£æ˜¯ Shell åŠ¨ç”»ç³»ç»Ÿçš„åŸºçŸ³ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªæ ‡å‡†ï¼Œè®©å„ç§åŠ¨ç”»ä¸“å®¶èƒ½å¤Ÿâ€œå³æ’å³ç”¨â€åœ°åŠ å…¥åˆ°åŠ¨ç”»ç³»ç»Ÿä¸­ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»ŸèŒè´£æ¸…æ™°ã€é«˜åº¦æ¨¡å—åŒ–ä¸”æ˜“äºæ‰©å±•ã€‚\nTransitionHandlerçš„å®ç°è€… frameworks/base/libs/WindowManager$ jgrep -nrE \"implements.*TransitionHandler\" ./Shell/src/com/android/wm/shell/transition/OneShotRemoteHandler.java:40:public class OneShotRemoteHandler implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/transition/DefaultMixedHandler.java:65:public class DefaultMixedHandler implements Transitions.TransitionHandler, ./Shell/src/com/android/wm/shell/transition/SleepHandler.java:36:class SleepHandler implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/transition/RemoteTransitionHandler.java:50:public class RemoteTransitionHandler implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/transition/DefaultTransitionHandler.java:120:public class DefaultTransitionHandler implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/unfold/UnfoldTransitionHandler.java:54:public class UnfoldTransitionHandler implements TransitionHandler, UnfoldListener { ./Shell/src/com/android/wm/shell/freeform/FreeformTaskTransitionHandler.java:46: implements Transitions.TransitionHandler, FreeformTaskTransitionStarter { ./Shell/src/com/android/wm/shell/desktopmode/ExitDesktopTaskTransitionHandler.java:53:public class ExitDesktopTaskTransitionHandler implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/desktopmode/EnterDesktopTaskTransitionHandler.java:49:public class EnterDesktopTaskTransitionHandler implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/taskview/TaskViewTransitions.java:49:public class TaskViewTransitions implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/activityembedding/ActivityEmbeddingController.java:49:public class ActivityEmbeddingController implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/pip/PipTransitionController.java:52:public abstract class PipTransitionController implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/keyguard/KeyguardTransitionHandler.java:58:public class KeyguardTransitionHandler implements Transitions.TransitionHandler { ./Shell/src/com/android/wm/shell/recents/RecentsTransitionHandler.java:67:public class RecentsTransitionHandler implements Transitions.TransitionHandler { ","wordCount":"231","inLanguage":"en","datePublished":"0001-01-01T00:00:00Z","dateModified":"0001-01-01T00:00:00Z","mainEntityOfPage":{"@type":"WebPage","@id":"https://ethen-cao.github.io/ethenslab/android-dev/windowmanager/wmshell/"},"publisher":{"@type":"Organization","name":"Ethen çš„å®éªŒå®¤","logo":{"@type":"ImageObject","url":"https://ethen-cao.github.io/ethenslab/favicon.ico"}}}</script></head><body id=top><script>localStorage.getItem("pref-theme")==="dark"?document.body.classList.add("dark"):localStorage.getItem("pref-theme")==="light"?document.body.classList.remove("dark"):window.matchMedia("(prefers-color-scheme: dark)").matches&&document.body.classList.add("dark")</script><header class=header><nav class=nav><div class=logo><a href=https://ethen-cao.github.io/ethenslab/ accesskey=h title="Ethen çš„å®éªŒå®¤ (Alt + H)">Ethen çš„å®éªŒå®¤</a><div class=logo-switches><button id=theme-toggle accesskey=t title="(Alt + T)" aria-label="Toggle theme">
<svg id="moon" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z"/></svg>
<svg id="sun" width="24" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"/><line x1="12" y1="1" x2="12" y2="3"/><line x1="12" y1="21" x2="12" y2="23"/><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"/><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"/><line x1="1" y1="12" x2="3" y2="12"/><line x1="21" y1="12" x2="23" y2="12"/><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"/><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"/></svg></button></div></div><ul id=menu><li><a href=https://ethen-cao.github.io/ethenslab/android-dev/ title=Androidç³»ç»Ÿå¼€å‘><span>Androidç³»ç»Ÿå¼€å‘</span></a></li><li><a href=https://ethen-cao.github.io/ethenslab/android-automotive-os-dev/ title="Android Automotive"><span>Android Automotive</span></a></li><li><a href=https://ethen-cao.github.io/ethenslab/qnx/ title=QNXå¼€å‘><span>QNXå¼€å‘</span></a></li><li><a href=https://ethen-cao.github.io/ethenslab/gunyah/ title=Gunyah><span>Gunyah</span></a></li><li><a href=https://ethen-cao.github.io/ethenslab/ivi-solution/ title=æ™ºèƒ½åº§èˆ±æ–¹æ¡ˆ><span>æ™ºèƒ½åº§èˆ±æ–¹æ¡ˆ</span></a></li><li><a href=https://ethen-cao.github.io/ethenslab/explore-ai title="Explore AI"><span>Explore AI</span></a></li></ul></nav></header><main class=main><article class=post-single><header class=post-header><div class=breadcrumbs><a href=https://ethen-cao.github.io/ethenslab/>Home</a>&nbsp;Â»&nbsp;<a href=https://ethen-cao.github.io/ethenslab/android-dev/>Androidç³»ç»Ÿå¼€å‘</a>&nbsp;Â»&nbsp;<a href=https://ethen-cao.github.io/ethenslab/android-dev/windowmanager/>WindowManager</a></div><h1 class="post-title entry-hint-parent"></h1><div class=post-meta>2 min&nbsp;Â·&nbsp;231 words</div></header><div class=post-content><h3 id=transitionhandler>TransitionHandler<a hidden class=anchor aria-hidden=true href=#transitionhandler>#</a></h3><p><code>TransitionHandler</code> æ˜¯ä¸€ä¸ª<strong>æ¥å£ (Interface)</strong>ï¼Œå®ƒä¸º Shell åŠ¨ç”»ç³»ç»Ÿå®šä¹‰äº†ä¸€ä¸ª**â€œåŠ¨ç”»å¤„ç†å™¨â€<strong>çš„æ ‡å‡†æˆ–</strong>å¥‘çº¦**ã€‚</p><p>å¯ä»¥æŠŠå®ƒæƒ³è±¡æˆä¸€ä¸ª<strong>ä¸“å®¶å²—ä½è¯´æ˜ä¹¦</strong> ğŸ“œã€‚ä»»ä½•ä¸€ä¸ªç±»ï¼Œåªè¦å®ç°äº† <code>TransitionHandler</code> æ¥å£ï¼Œå°±æ„å‘³ç€å®ƒå…·å¤‡äº†å¤„ç†ä¸€ç±»ç‰¹å®šçª—å£è¿‡æ¸¡åŠ¨ç”»çš„ä¸“ä¸šèƒ½åŠ›ï¼Œå¹¶å¯ä»¥è¢« <code>Transitions</code> ï¼ˆåŠ¨ç”»æ€»è°ƒåº¦å®¤ï¼‰ç»Ÿä¸€ç®¡ç†å’Œè°ƒåº¦ã€‚</p><h4 id=æ ¸å¿ƒèŒè´£>æ ¸å¿ƒèŒè´£<a hidden class=anchor aria-hidden=true href=#æ ¸å¿ƒèŒè´£>#</a></h4><p>ä¸€ä¸ª <code>TransitionHandler</code> å®ç°ç±»ï¼Œå…¶æ ¸å¿ƒèŒè´£ä¸»è¦æœ‰ä¸¤ä¸ªï¼š</p><h5 id=1-è®¤é¢†ä»»åŠ¡-claim-the-job---é€šè¿‡-handlerequest-æ–¹æ³•>1. è®¤é¢†ä»»åŠ¡ (Claim the Job) - é€šè¿‡ <code>handleRequest</code> æ–¹æ³•<a hidden class=anchor aria-hidden=true href=#1-è®¤é¢†ä»»åŠ¡-claim-the-job---é€šè¿‡-handlerequest-æ–¹æ³•>#</a></h5><p>è¿™æ˜¯ <code>TransitionHandler</code> <strong>æœ€å…³é”®</strong>çš„èŒè´£ã€‚å½“ <code>Transitions.requestStartTransition</code> æ–¹æ³•æ”¶åˆ°ä¸€ä¸ªæ¥è‡ªç³»ç»Ÿçš„åŠ¨ç”»è¯·æ±‚æ—¶ï¼Œå®ƒä¼šéå†å…¶å†…éƒ¨çš„ <code>Handler</code> åˆ—è¡¨ï¼Œå¹¶è°ƒç”¨æ¯ä¸ª <code>Handler</code> çš„ <code>handleRequest</code> æ–¹æ³•ã€‚</p><ul><li><p><strong>â€œè¿™æ˜¯æˆ‘çš„æ´»å„¿å—ï¼Ÿâ€</strong>: åœ¨ <code>handleRequest</code> æ–¹æ³•å†…éƒ¨ï¼Œ<code>Handler</code> ä¼šæ£€æŸ¥ä¼ å…¥çš„ <code>TransitionRequestInfo</code>ï¼ˆåŠ¨ç”»è¯·æ±‚ä¿¡æ¯ï¼‰ï¼Œæ ¹æ®åŠ¨ç”»çš„ç±»å‹ (<code>type</code>)ã€è§¦å‘ä»»åŠ¡ (<code>triggerTask</code>)ã€çª—å£æ¨¡å¼ç­‰ä¿¡æ¯ï¼Œæ¥åˆ¤æ–­è¿™æ˜¯å¦æ˜¯è‡ªå·±åº”è¯¥å¤„ç†çš„åŠ¨ç”»åœºæ™¯ã€‚</p><ul><li>ä¾‹å¦‚ï¼Œ<code>RecentsTransitionHandler</code> ä¼šæ£€æŸ¥åŠ¨ç”»ç±»å‹æ˜¯å¦ä¸â€œæœ€è¿‘ä»»åŠ¡â€ç›¸å…³ã€‚</li><li><code>UnfoldTransitionHandler</code> ä¼šæ£€æŸ¥è®¾å¤‡æ˜¯å¦æ­£åœ¨æŠ˜å /å±•å¼€ã€‚</li></ul></li><li><p><strong>å¦‚ä½•è®¤é¢†</strong>:</p><ul><li>å¦‚æœ <code>Handler</code> å†³å®šå¤„ç†è¿™ä¸ªè¯·æ±‚ï¼Œå®ƒä¼šè¿”å›ä¸€ä¸ª <code>WindowContainerTransaction</code> å¯¹è±¡ï¼ˆå³ä½¿è¿™ä¸ªå¯¹è±¡æ˜¯ç©ºçš„ï¼‰ã€‚è¿™å°±åƒä¸¾æ‰‹è¯´ï¼šâ€œè¿™ä¸ªæˆ‘æ¥å¤„ç†ï¼â€</li><li>å¦‚æœ <code>Handler</code> è®¤ä¸ºè¿™ä¸ªè¯·æ±‚ä¸å½’è‡ªå·±ç®¡ï¼Œå®ƒä¼šè¿”å› <code>null</code>ã€‚<code>Transitions</code> çœ‹åˆ° <code>null</code> åï¼Œå°±ä¼šç»§ç»­å»é—®ä¸‹ä¸€ä¸ª <code>Handler</code>ã€‚</li></ul></li></ul><h5 id=2-æ‰§è¡ŒåŠ¨ç”»-execute-the-animation>2. æ‰§è¡ŒåŠ¨ç”» (Execute the Animation)<a hidden class=anchor aria-hidden=true href=#2-æ‰§è¡ŒåŠ¨ç”»-execute-the-animation>#</a></h5><p>ä¸€æ—¦ä¸€ä¸ª <code>Handler</code> é€šè¿‡è¿”å›é <code>null</code> çš„ <code>WCT</code> æˆåŠŸâ€œè®¤é¢†â€äº†ä¸€ä¸ª <code>Transition</code>ï¼Œå®ƒå°±<strong>å…¨æƒè´Ÿè´£</strong>è¿™ä¸ª <code>Transition</code> çš„åŠ¨ç”»å®ç°ã€‚</p><ul><li><strong>å‡†å¤‡ä¸æ‰§è¡Œ</strong>: å½“ <code>TransitionController</code> å®Œæˆæ‰€æœ‰å‡†å¤‡å·¥ä½œï¼Œå¹¶é€šè¿‡ <code>onTransitionReady</code> å°†åŒ…å«å®Œæ•´ä¿¡æ¯çš„ <code>TransitionInfo</code> å‘é€å› Shell åï¼Œ<code>Transitions</code> æ€»è°ƒåº¦å®¤ä¼šç¡®ä¿å°†è¿™ä¸ª <code>TransitionInfo</code> äº¤ç»™å½“åˆè®¤é¢†äº†å®ƒçš„é‚£ä¸ª <code>Handler</code>ã€‚</li><li><strong>å…·ä½“çš„åŠ¨ç”»é€»è¾‘</strong>: <code>Handler</code> å†…éƒ¨ä¼šåŒ…å«å…·ä½“çš„åŠ¨ç”»ä»£ç ã€‚å®ƒä¼šè§£æ <code>TransitionInfo</code>ï¼Œè·å–éœ€è¦æ“ä½œçš„çª—å£å›¾å±‚ï¼ˆLeashesï¼‰ï¼Œç„¶åä½¿ç”¨ <code>SurfaceControl.Transaction</code> æ¥å®ç°å¹³ç§»ã€ç¼©æ”¾ã€é€æ˜åº¦å˜åŒ–ç­‰ä¸€ç³»åˆ—è§†è§‰æ•ˆæœï¼Œæœ€ç»ˆæ„æˆä¸€ä¸ªå®Œæ•´çš„åŠ¨ç”»ã€‚</li></ul><h4 id=è®¾è®¡æ¨¡å¼ä¸ä¼˜åŠ¿>è®¾è®¡æ¨¡å¼ä¸ä¼˜åŠ¿<a hidden class=anchor aria-hidden=true href=#è®¾è®¡æ¨¡å¼ä¸ä¼˜åŠ¿>#</a></h4><p>è¿™ä¸ªè®¾è®¡é‡‡ç”¨äº†ç»å…¸çš„<strong>è´£ä»»é“¾æ¨¡å¼ (Chain of Responsibility)</strong> æˆ–<strong>ç­–ç•¥æ¨¡å¼ (Strategy Pattern)</strong>ã€‚</p><ul><li><strong>æ¨¡å—åŒ– (Modularity)</strong>: å°†ä¸åŒåœºæ™¯çš„åŠ¨ç”»é€»è¾‘<strong>éš”ç¦»</strong>åœ¨å„è‡ªç‹¬ç«‹çš„ <code>Handler</code> ç±»ä¸­ã€‚<code>RecentsTransitionHandler</code> åªå…³å¿ƒâ€œæœ€è¿‘ä»»åŠ¡â€ï¼Œ<code>PipTransitionController</code> åªå…³å¿ƒç”»ä¸­ç”»ï¼Œå®ƒä»¬äº’ä¸å¹²æ‰°ã€‚</li><li><strong>å¯æ‰©å±•æ€§ (Extensibility)</strong>: è¿™ä¸ªæ¶æ„éå¸¸å®¹æ˜“æ‰©å±•ã€‚å¦‚æœæœªæ¥ Android å¢åŠ äº†ä¸€ç§æ–°çš„çª—å£æ¨¡å¼ï¼ˆæ¯”å¦‚â€œè¿·ä½ æ¨¡å¼â€ï¼‰ï¼Œå¼€å‘è€…åªéœ€è¦ï¼š<ol><li>åˆ›å»ºä¸€ä¸ªæ–°çš„ <code>MiniModeTransitionHandler</code> ç±»ï¼Œå¹¶å®ç° <code>TransitionHandler</code> æ¥å£ã€‚</li><li>åœ¨æ–°ç±»ä¸­ç¼–å†™è¿›å…¥/é€€å‡ºâ€œè¿·ä½ æ¨¡å¼â€çš„åŠ¨ç”»é€»è¾‘ã€‚</li><li>å°†è¿™ä¸ªæ–°çš„ <code>Handler</code> æ³¨å†Œåˆ° <code>Transitions</code> çš„ <code>Handler</code> åˆ—è¡¨ä¸­ã€‚
æ•´ä¸ªåŠ¨ç”»ç³»ç»Ÿå°±èƒ½è‡ªåŠ¨æ”¯æŒè¿™ç§æ–°çš„åŠ¨ç”»ï¼Œè€Œæ— éœ€ä¿®æ”¹ä»»ä½•ç°æœ‰çš„æ ¸å¿ƒä»£ç ã€‚</li></ol></li><li><strong>ä¼˜å…ˆçº§ (Prioritization)</strong>: <code>Transitions</code> å†…éƒ¨çš„ <code>Handler</code> åˆ—è¡¨æ˜¯æœ‰é¡ºåºçš„ã€‚è¿™å…è®¸ç³»ç»Ÿå®šä¹‰å¤„ç†çš„<strong>ä¼˜å…ˆçº§</strong>ã€‚æ¯”å¦‚ï¼Œ<code>UnfoldTransitionHandler</code>ï¼ˆæŠ˜å å±ä¸“å®¶ï¼‰çš„ä¼˜å…ˆçº§ä¼šé«˜äº <code>DefaultTransitionHandler</code>ï¼ˆé€šç”¨ä¸“å®¶ï¼‰ï¼Œç¡®ä¿åœ¨æŠ˜å å±è®¾å¤‡ä¸Šï¼Œä¼˜å…ˆæ‰§è¡Œä¸“é—¨ä¸ºæŠ˜å å±ä¼˜åŒ–çš„åŠ¨ç”»ã€‚</li></ul><h4 id=æ€»ç»“>æ€»ç»“<a hidden class=anchor aria-hidden=true href=#æ€»ç»“>#</a></h4><p><code>TransitionHandler</code> æ¥å£æ˜¯ Shell åŠ¨ç”»ç³»ç»Ÿçš„<strong>åŸºçŸ³</strong>ã€‚å®ƒå®šä¹‰äº†ä¸€ä¸ªæ ‡å‡†ï¼Œè®©å„ç§<strong>åŠ¨ç”»ä¸“å®¶</strong>èƒ½å¤Ÿâ€œå³æ’å³ç”¨â€åœ°åŠ å…¥åˆ°åŠ¨ç”»ç³»ç»Ÿä¸­ï¼Œä½¿å¾—æ•´ä¸ªç³»ç»Ÿ<strong>èŒè´£æ¸…æ™°ã€é«˜åº¦æ¨¡å—åŒ–ä¸”æ˜“äºæ‰©å±•</strong>ã€‚</p><h4 id=transitionhandlerçš„å®ç°è€…>TransitionHandlerçš„å®ç°è€…<a hidden class=anchor aria-hidden=true href=#transitionhandlerçš„å®ç°è€…>#</a></h4><div class=highlight><pre tabindex=0 style=color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-txt data-lang=txt><span style=display:flex><span>frameworks/base/libs/WindowManager$ jgrep -nrE &#34;implements.*TransitionHandler&#34;
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/transition/OneShotRemoteHandler.java:40:public class OneShotRemoteHandler implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/transition/DefaultMixedHandler.java:65:public class DefaultMixedHandler implements Transitions.TransitionHandler,
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/transition/SleepHandler.java:36:class SleepHandler implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/transition/RemoteTransitionHandler.java:50:public class RemoteTransitionHandler implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/transition/DefaultTransitionHandler.java:120:public class DefaultTransitionHandler implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/unfold/UnfoldTransitionHandler.java:54:public class UnfoldTransitionHandler implements TransitionHandler, UnfoldListener {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/freeform/FreeformTaskTransitionHandler.java:46:        implements Transitions.TransitionHandler, FreeformTaskTransitionStarter {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/desktopmode/ExitDesktopTaskTransitionHandler.java:53:public class ExitDesktopTaskTransitionHandler implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/desktopmode/EnterDesktopTaskTransitionHandler.java:49:public class EnterDesktopTaskTransitionHandler implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/taskview/TaskViewTransitions.java:49:public class TaskViewTransitions implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/activityembedding/ActivityEmbeddingController.java:49:public class ActivityEmbeddingController implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/pip/PipTransitionController.java:52:public abstract class PipTransitionController implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/keyguard/KeyguardTransitionHandler.java:58:public class KeyguardTransitionHandler implements Transitions.TransitionHandler {
</span></span><span style=display:flex><span>./Shell/src/com/android/wm/shell/recents/RecentsTransitionHandler.java:67:public class RecentsTransitionHandler implements Transitions.TransitionHandler {
</span></span></code></pre></div></div><footer class=post-footer><ul class=post-tags></ul><nav class=paginav><a class=prev href=https://ethen-cao.github.io/ethenslab/android-dev/visualquerydetector/visualquerydetector/><span class=title>Â« Prev</span><br><span></span></a></nav></footer></article></main><footer class=footer><span>&copy; 2026 <a href=https://ethen-cao.github.io/ethenslab/>Ethen çš„å®éªŒå®¤</a></span> Â·
<span>Powered by
<a href=https://gohugo.io/ rel="noopener noreferrer" target=_blank>Hugo</a> &
<a href=https://github.com/adityatelange/hugo-PaperMod/ rel=noopener target=_blank>PaperMod</a></span></footer><a href=#top aria-label="go to top" title="Go to Top (Alt + G)" class=top-link id=top-link accesskey=g><svg viewBox="0 0 12 6" fill="currentColor"><path d="M12 6H0l6-6z"/></svg>
</a><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:!0,theme:"default"})</script><script src=https://cdn.jsdelivr.net/npm/plantuml-encoder@1.4.0/dist/plantuml-encoder.min.js></script><script>(function(){const e=document.querySelectorAll("pre > code.language-plantuml, pre > code.language-planuml");e.forEach(e=>{const s=e.innerText,o=plantumlEncoder.encode(s),i="https://www.plantuml.com/plantuml/svg/"+o,t=document.createElement("img");t.src=i,t.alt="PlantUML Diagram",t.style.maxWidth="100%";const n=e.parentNode;n.parentNode.replaceChild(t,n)})})()</script><script>let menu=document.getElementById("menu");menu&&(menu.scrollLeft=localStorage.getItem("menu-scroll-position"),menu.onscroll=function(){localStorage.setItem("menu-scroll-position",menu.scrollLeft)}),document.querySelectorAll('a[href^="#"]').forEach(e=>{e.addEventListener("click",function(e){e.preventDefault();var t=this.getAttribute("href").substr(1);window.matchMedia("(prefers-reduced-motion: reduce)").matches?document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView():document.querySelector(`[id='${decodeURIComponent(t)}']`).scrollIntoView({behavior:"smooth"}),t==="top"?history.replaceState(null,null," "):history.pushState(null,null,`#${t}`)})})</script><script>var mybutton=document.getElementById("top-link");window.onscroll=function(){document.body.scrollTop>800||document.documentElement.scrollTop>800?(mybutton.style.visibility="visible",mybutton.style.opacity="1"):(mybutton.style.visibility="hidden",mybutton.style.opacity="0")}</script><script>document.getElementById("theme-toggle").addEventListener("click",()=>{document.body.className.includes("dark")?(document.body.classList.remove("dark"),localStorage.setItem("pref-theme","light")):(document.body.classList.add("dark"),localStorage.setItem("pref-theme","dark"))})</script><script>document.querySelectorAll("pre > code").forEach(e=>{const n=e.parentNode.parentNode,t=document.createElement("button");t.classList.add("copy-code"),t.innerHTML="copy";function s(){t.innerHTML="copied!",setTimeout(()=>{t.innerHTML="copy"},2e3)}t.addEventListener("click",t=>{if("clipboard"in navigator){navigator.clipboard.writeText(e.textContent),s();return}const n=document.createRange();n.selectNodeContents(e);const o=window.getSelection();o.removeAllRanges(),o.addRange(n);try{document.execCommand("copy"),s()}catch{}o.removeRange(n)}),n.classList.contains("highlight")?n.appendChild(t):n.parentNode.firstChild==n||(e.parentNode.parentNode.parentNode.parentNode.parentNode.nodeName=="TABLE"?e.parentNode.parentNode.parentNode.parentNode.parentNode.appendChild(t):e.parentNode.appendChild(t))})</script></body></html>